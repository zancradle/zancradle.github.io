var R=Object.defineProperty;var B=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;var I=(e,s,l)=>s in e?R(e,s,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[s]=l,E=(e,s)=>{for(var l in s||(s={}))M.call(s,l)&&I(e,l,s[l]);if(B)for(var l of B(s))P.call(s,l)&&I(e,l,s[l]);return e};var N=(e,s,l)=>new Promise((g,b)=>{var h=n=>{try{i(l.next(n))}catch(d){b(d)}},D=n=>{try{i(l.throw(n))}catch(d){b(d)}},i=n=>n.done?g(n.value):Promise.resolve(n.value).then(h,D);i((l=l.apply(e,s)).next())});import{B as q,n as L}from"./useForm.64137a1f.js";import{e9 as m,ea as j,c as k,az as _,a as O,I as $,db as V,bk as G,v as f,f as H,i as A,aB as c,o as J,j as z,B as u,n as o,m as U,bm as w,aC as X,C as S}from"./index.c8efd86c.js";import{t as K,C as W,a as Q,q as Y,i as Z}from"./dict.b085f5a7.js";import{B as x,u as ee}from"./useTable.2dfc64b8.js";import{B as ae,a as te}from"./index.29932cc5.js";import{C as oe}from"./index.f0acda50.js";import{T as le}from"./index.27ad186e.js";import{I as se}from"./index.e7beea07.js";import{D as ue}from"./index.59448792.js";function ke(e){return m.post({url:"/codegen/query",params:e},{errorMessageMode:"message"})}function re(){return m.get({url:"/codegen/tables"},{errorMessageMode:"message"})}function Ue(e){return m.get({url:"/codegen/query",params:{tableName:e}},{errorMessageMode:"message"})}function Re(e){return m.get({url:"/codegen/query/"+e},{errorMessageMode:"message"})}function Me(e){return m.post({url:"/codegen/generate",params:e,responseType:"blob"},{errorMessageMode:"message",isReturnNativeResponse:!0})}function ne(e){return m.post({url:"/codegen/save",params:e},{errorMessageMode:"message"})}function de(e,s){return m.post({url:"/codegen/update/"+e,params:s},{errorMessageMode:"message"})}function Pe(e){return m.delete({url:"/codegen/delete",headers:{"Content-Type":j.FORM_URLENCODED},params:{id:e}},{errorMessageMode:"message"})}const{t:r}=k(),qe=[{title:r("sys.codegen.tableName"),dataIndex:"tableName"},{title:r("sys.codegen.menuName"),dataIndex:"menuName"},{title:r("sys.codegen.moduleName"),dataIndex:"moduleName"},{title:r("sys.codegen.className"),dataIndex:"className"},{title:r("sys.codegen.template"),dataIndex:"template",customRender:({record:e})=>K.get(e.template)},{title:r("common.updateTime"),dataIndex:"updateTime",ellipsis:!0}],Le=[{field:"tableName",label:r("sys.codegen.tableName"),component:"ApiSelect",componentProps:{api:re,labelField:"tableName",valueField:"tableName",alwaysLoad:!0},colProps:{span:8}}],ce=[{field:"tableName",label:r("sys.codegen.tableName"),component:"Input",rules:[{required:!0,message:"\u8868\u4E0D\u80FD\u4E3A\u7A7A",whitespace:!0}],colProps:{md:8}},{field:"menuName",label:r("sys.codegen.menuName"),component:"Input",rules:[{required:!0,message:"\u83DC\u5355\u540D\u4E0D\u80FD\u4E3A\u7A7A",whitespace:!0}],colProps:{md:8}},{field:"moduleName",label:r("sys.codegen.moduleName"),component:"Input",rules:[{required:!0,message:"\u6A21\u5757\u540D\u4E0D\u80FD\u4E3A\u7A7A",whitespace:!0}],componentProps:{placeholder:"\u82F1\u6587\u540D\u5982sys"},colProps:{md:8}},{field:"functionName",label:r("sys.codegen.functionName"),component:"Input",rules:[{required:!0,message:"\u529F\u80FD\u540D\u4E0D\u80FD\u4E3A\u7A7A",whitespace:!0}],componentProps:{placeholder:"\u82F1\u6587\u540D\u5982demo"},colProps:{md:8}},{field:"className",label:r("sys.codegen.className"),component:"Input",rules:[{required:!0,message:"\u7C7B\u540D\u4E0D\u80FD\u4E3A\u7A7A",whitespace:!0}],componentProps:{placeholder:"\u82F1\u6587\u540D\u5982SysDemo"},colProps:{md:8}},{field:"templateType",label:r("sys.codegen.template"),component:"Select",rules:[{required:!0,message:"\u7C7B\u540D\u4E0D\u80FD\u4E3A\u7A7A",whitespace:!0}],defaultValue:W.JAVA_CRUD,componentProps:{options:Q},colProps:{md:8}}],ie=[{title:"\u5217\u540D",align:"left",dataIndex:"dbColumnName"},{title:"\u5B57\u6BB5\u540D",dataIndex:"labelName",slots:{customRender:"labelName",title:"labelName"}},{title:"DB\u7C7B\u578B",align:"left",dataIndex:"columnType"},{title:"Java\u7C7B\u578B",align:"left",dataIndex:"javaType"},{title:"Java\u5B57\u6BB5\u540D\u79F0",dataIndex:"javaFieldName",slots:{customRender:"javaFieldName",title:"javaFieldNameTitle"}},{title:"\u53EF\u7A7A | \u63D2\u5165 | \u66F4\u65B0",dataIndex:"nullable|insert|update",slots:{customRender:"nullable|insert|update"}},{title:"\u5217\u8868 | \u6392\u5E8F",dataIndex:"list|sortable",slots:{customRender:"list|sortable"}},{title:"\u67E5\u8BE2",dataIndex:"search",slots:{customRender:"search"},width:60},{title:"\u67E5\u8BE2\u65B9\u5F0F",dataIndex:"queryType",slots:{customRender:"queryType"}},{title:"\u8868\u5355\u7C7B\u578B",dataIndex:"inputType",slots:{customRender:"inputType"}},{title:"\u5B57\u5178",dataIndex:"dictType",slots:{customRender:"dictType"}},{title:"\u987A\u5E8F",dataIndex:"sort",slots:{customRender:"sort"}}],pe=O({name:"CodegenDrawer",components:{BasicDrawer:ae,BasicForm:q,BasicTable:x,Checkbox:oe,TypographyText:le,Input:$,InputNumber:se,Select:V,Tooltip:G,Divider:ue},emits:["success","register"],setup(e,{emit:s}){let l=f([]);const{t:g}=k(),b=f(""),h=f(!0);let D=f([]);const[i,{resetFields:n,setFieldsValue:d,validate:p}]=L({labelWidth:80,schemas:ce,showActionButtonGroup:!1,baseColProps:{md:8}}),[v]=ee({columns:ie,pagination:!1,dataSource:l,showIndexColumn:!1,showTableSetting:!1}),[y,{setDrawerProps:T,closeDrawer:C}]=te(t=>N(this,null,function*(){yield n(),T({confirmLoading:!1}),h.value=!!(t!=null&&t.isUpdate),b.value=t==null?void 0:t.id,yield d(E({},t.record)),l.value=t.record.columnPlans})),F=H(()=>A(h)?g("common.editText"):g("common.createText"));function a(){return N(this,null,function*(){try{const t=yield p();t.columnPlans=l.value,T({confirmLoading:!0}),A(h)?yield de(b.value,t):yield ne(t),C(),s("success")}finally{T({confirmLoading:!1})}})}return{dictTypeDict:D,registerDrawer:y,registerForm:i,registerTable:v,tableDataSource:l,getTitle:F,queryTypeDict:Y,inputTypeDict:Z,handleSubmit:a}},methods:{allowedSearchAndShow(e){return!["RICH_TEXT","IMAGE","FILE"].includes(this.tableDataSource[e].inputType)},inputTypeChange(e){["RICH_TEXT","IMAGE","FILE"].includes(this.tableDataSource[e].inputType)&&(this.tableDataSource[e].search=!1,this.tableDataSource[e].list=!1,this.tableDataSource[e].sortable=!1,this.tableDataSource[e].queryType="NONE")},dictField(e){return["SELECT","SELECT_MULTIPLE","RADIO","CHECKBOX"].includes(this.tableDataSource[e].inputType)}}}),me={class:"p-4"},be=S("*"),he=S(" \u5B57\u6BB5\u540D "),ge=S("*"),De=S(" Java\u5B57\u6BB5\u540D "),ye=U("span",null,"\u914D\u5408\u67E5\u8BE2\u65B9\u5F0F",-1);function Te(e,s,l,g,b,h){const D=c("BasicForm"),i=c("TypographyText"),n=c("Input"),d=c("Divider"),p=c("Checkbox"),v=c("Tooltip"),y=c("Select"),T=c("InputNumber"),C=c("BasicTable"),F=c("BasicDrawer");return J(),z(F,X(e.$attrs,{onRegister:e.registerDrawer,showFooter:"",title:e.getTitle,width:"95%",onOk:e.handleSubmit}),{default:u(()=>[o(D,{onRegister:e.registerForm},null,8,["onRegister"]),U("div",me,[o(C,{onRegister:e.registerTable},{fieldNameTitle:u(()=>[o(i,{type:"danger"},{default:u(()=>[be]),_:1}),he]),javaFieldNameTitle:u(()=>[o(i,{type:"danger"},{default:u(()=>[ge]),_:1}),De]),labelName:u(({index:a})=>[o(n,{value:e.tableDataSource[a].labelName,"onUpdate:value":t=>e.tableDataSource[a].labelName=t,maxlength:6,style:w({border:e.tableDataSource[a].labelName?"":"1px solid red"}),placeholder:"\u6700\u957F6"},null,8,["value","onUpdate:value","style"])]),javaFieldName:u(({index:a})=>[o(n,{value:e.tableDataSource[a].javaFieldName,"onUpdate:value":t=>e.tableDataSource[a].javaFieldName=t,disabled:e.tableDataSource[a].defaultField,maxlength:20,style:w({border:e.tableDataSource[a].javaFieldName?"":"1px solid red"})},null,8,["value","onUpdate:value","disabled","style"])]),"nullable|insert|update":u(({index:a})=>[o(d,{dashed:!0,type:"vertical"}),o(p,{checked:e.tableDataSource[a].nullable,"onUpdate:checked":t=>e.tableDataSource[a].nullable=t},null,8,["checked","onUpdate:checked"]),o(d,{type:"vertical"}),o(p,{checked:e.tableDataSource[a].insert,"onUpdate:checked":t=>e.tableDataSource[a].insert=t},null,8,["checked","onUpdate:checked"]),o(d,{type:"vertical"}),o(p,{checked:e.tableDataSource[a].update,"onUpdate:checked":t=>e.tableDataSource[a].update=t},null,8,["checked","onUpdate:checked"])]),"list|sortable":u(({index:a})=>[o(d,{dashed:!0,type:"vertical"}),o(p,{checked:e.tableDataSource[a].list,"onUpdate:checked":t=>e.tableDataSource[a].list=t,disabled:!e.allowedSearchAndShow(a)},null,8,["checked","onUpdate:checked","disabled"]),o(d,{type:"vertical"}),o(p,{checked:e.tableDataSource[a].sortable,"onUpdate:checked":t=>e.tableDataSource[a].sortable=t,disabled:!e.allowedSearchAndShow(a)},null,8,["checked","onUpdate:checked","disabled"])]),search:u(({index:a})=>[o(v,{placement:"top"},{title:u(()=>[ye]),default:u(()=>[o(p,{checked:e.tableDataSource[a].search,"onUpdate:checked":t=>e.tableDataSource[a].search=t,disabled:!e.allowedSearchAndShow(a)},null,8,["checked","onUpdate:checked","disabled"])]),_:2},1024)]),queryType:u(({index:a})=>[o(y,{value:e.tableDataSource[a].queryType,"onUpdate:value":t=>e.tableDataSource[a].queryType=t,allowClear:!0,disabled:!e.allowedSearchAndShow(a),options:e.queryTypeDict,style:{width:"100px"}},null,8,["value","onUpdate:value","disabled","options"])]),inputType:u(({index:a})=>[o(y,{value:e.tableDataSource[a].inputType,"onUpdate:value":t=>e.tableDataSource[a].inputType=t,allowClear:!0,options:e.inputTypeDict,style:{width:"110px"},onChange:t=>e.inputTypeChange(a)},null,8,["value","onUpdate:value","options","onChange"])]),dictType:u(({index:a})=>[o(y,{value:e.tableDataSource[a].dictType,"onUpdate:value":t=>e.tableDataSource[a].dictType=t,allowClear:!0,disabled:!e.dictField(a),options:e.dictTypeDict,placeholder:"\u53EFdata.ts\u8865\u5168","show-search":"",style:{width:"140px"}},null,8,["value","onUpdate:value","disabled","options"])]),sort:u(({index:a})=>[o(T,{value:e.tableDataSource[a].sort,"onUpdate:value":t=>e.tableDataSource[a].sort=t,maxlength:20,step:10,style:w({border:e.tableDataSource[a].sort!=null?"":"1px solid red"}),placeholder:"\u5347\u5E8F"},null,8,["value","onUpdate:value","style"])]),_:1},8,["onRegister"])])]),_:1},16,["onRegister","title","onOk"])}var fe=_(pe,[["render",Te]]),je=Object.freeze(Object.defineProperty({__proto__:null,default:fe},Symbol.toStringTag,{value:"Module"}));export{fe as C,Ue as a,Re as b,qe as c,Pe as d,Me as e,je as f,ke as g,Le as s};
