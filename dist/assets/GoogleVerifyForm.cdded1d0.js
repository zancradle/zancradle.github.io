var k=(p,c,o)=>new Promise((r,g)=>{var m=s=>{try{l(o.next(s))}catch(a){g(a)}},f=s=>{try{l(o.throw(s))}catch(a){g(a)}},l=s=>s.done?r(s.value):Promise.resolve(s.value).then(m,f);l((o=o.apply(p,c)).next())});import{a as T,c as w,s as L,v,w as B,f as E,i as e,o as V,h as R,n,B as i,I as b,D as C,C as _,t as x,E as D,F as G,k as z,G as K}from"./index.c8efd86c.js";import{F}from"./index.5bccfa61.js";import"./index.d99ed209.js";import{u as N,a as U,L as $,_ as M,b as O}from"./LoginFormTitle.282d3bb9.js";import"./_baseIteratee.813ccf6c.js";import"./get.a8e0dbdb.js";import"./useSize.822cfd2a.js";const W=T({setup(p){const c=F.Item,{t:o}=w(),r=L(),{notification:g}=K(),{handleBackLogin:m,getLoginState:f}=N(),{getFormRules:l}=U(),s=v(),a=v(!1),d=B({verifyToken:"",googleCode:""}),{validForm:S}=O(s),h=E(()=>e(f)===$.GOOGLE_VERIFY);function y(){return k(this,null,function*(){const u=yield S();u.verifyToken=r.verifyToken;try{a.value=!0;const t=yield r.login({verifyToken:u.verifyToken,googleCode:u.googleCode,mode:"message"});t&&g.success({message:o("sys.login.loginSuccessTitle"),description:`${o("sys.login.loginSuccessDesc")}: ${t.name}`,duration:3}),r.setVerifyToken(""),r.setGoogleQrUrl("")}catch(t){console.error(t.message||o("sys.api.networkExceptionMsg"))}finally{a.value=!1}})}return(u,t)=>e(h)?(V(),R(G,{key:0},[n(M,{class:"enter-x"}),n(e(F),{class:"p-4 enter-x",model:e(d),rules:e(l),ref_key:"formRef",ref:s,onKeypress:D(y,["enter"])},{default:i(()=>[n(e(c),{name:"googleCode",class:"enter-x"},{default:i(()=>[n(e(b),{size:"large",value:e(d).googleCode,"onUpdate:value":t[0]||(t[0]=I=>e(d).googleCode=I),placeholder:e(o)("sys.login.googleCode"),class:"fix-auto-fill"},null,8,["value","placeholder"])]),_:1}),n(e(c),{class:"enter-x"},{default:i(()=>[n(e(C),{type:"primary",size:"large",block:"",onClick:y,loading:a.value},{default:i(()=>[_(x(e(o)("sys.login.verifyButton")),1)]),_:1},8,["loading"]),n(e(C),{size:"large",block:"",class:"mt-4",onClick:e(m)},{default:i(()=>[_(x(e(o)("sys.login.backSignIn")),1)]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules","onKeypress"])],64)):z("",!0)}});export{W as default};
