var x=(v,u,o)=>new Promise((a,g)=>{var f=s=>{try{r(o.next(s))}catch(i){g(i)}},l=s=>{try{r(o.throw(s))}catch(i){g(i)}},r=s=>s.done?a(s.value):Promise.resolve(s.value).then(f,l);r((o=o.apply(v,u)).next())});import{a as B,c as D,s as I,v as C,f as T,i as e,w as L,o as V,h as b,n as t,m as E,y as G,z as N,B as c,I as z,E as Q,C as p,t as y,D as h,F as R,k as U,G as K}from"./index.c8efd86c.js";import{a as $,u as j,L as M,_ as O,b as q}from"./LoginFormTitle.282d3bb9.js";import{F as S}from"./index.5bccfa61.js";import"./index.d99ed209.js";import{D as A}from"./index.59448792.js";import{Q as H}from"./index.e28abc18.js";import"./_baseIteratee.813ccf6c.js";import"./get.a8e0dbdb.js";import"./useSize.822cfd2a.js";import"./download.b01f8fdc.js";const J={class:"enter-x min-w-64 min-h-64"},re=B({setup(v){const u=S.Item,{t:o}=D(),a=I(),{getFormRules:g}=$(),{notification:f}=K(),l=C(!1),r=C(),{validForm:s}=q(r),{handleBackLogin:i,getLoginState:w}=j(),k=T(()=>e(w)===M.GOOGLE_BIND),d=L({verifyToken:"",googleCode:""});function _(){return x(this,null,function*(){const m=yield s();m.verifyToken=a.verifyToken;try{l.value=!0;const n=yield a.login({verifyToken:m.verifyToken,googleCode:m.googleCode,mode:"message"});n&&f.success({message:o("sys.login.loginSuccessTitle"),description:`${o("sys.login.loginSuccessDesc")}: ${n.name}`,duration:3}),a.setVerifyToken(""),a.setGoogleQrUrl("")}catch(n){console.error(n.message||o("sys.api.networkExceptionMsg"))}finally{l.value=!1}})}return(m,n)=>e(k)?(V(),b(R,{key:0},[t(O,{class:"enter-x"}),E("div",J,[t(e(H),{value:e(a).getGoogleQrUrl,class:"enter-x flex justify-center xl:justify-start",width:280},null,8,["value"]),G(t(e(S),{class:"p-4 enter-x",model:e(d),rules:e(g),ref_key:"formRef",ref:r,onKeypress:Q(_,["enter"])},{default:c(()=>[t(e(u),{name:"googleCode",class:"enter-x"},{default:c(()=>[t(e(z),{size:"large",value:e(d).googleCode,"onUpdate:value":n[0]||(n[0]=F=>e(d).googleCode=F),placeholder:e(o)("sys.login.googleCode"),class:"fix-auto-fill"},null,8,["value","placeholder"])]),_:1})]),_:1},8,["model","rules","onKeypress"]),[[N,e(k)]]),t(e(A),{class:"enter-x"},{default:c(()=>[p(y(e(o)("sys.login.googleScan")),1)]),_:1}),t(e(h),{type:"primary",size:"large",block:"",onClick:_,loading:l.value},{default:c(()=>[p(y(e(o)("sys.login.bindButton")),1)]),_:1},8,["loading"]),t(e(h),{size:"large",block:"",class:"mt-4 enter-x",onClick:e(i)},{default:c(()=>[p(y(e(o)("sys.login.backSignIn")),1)]),_:1},8,["onClick"])])],64)):U("",!0)}});export{re as default};
