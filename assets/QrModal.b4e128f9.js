var U=Object.defineProperty,P=Object.defineProperties;var R=Object.getOwnPropertyDescriptors;var Q=Object.getOwnPropertySymbols;var _=Object.prototype.hasOwnProperty,b=Object.prototype.propertyIsEnumerable;var S=(e,s,r)=>s in e?U(e,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[s]=r,y=(e,s)=>{for(var r in s||(s={}))_.call(s,r)&&S(e,r,s[r]);if(Q)for(var r of Q(s))b.call(s,r)&&S(e,r,s[r]);return e},p=(e,s)=>P(e,R(s));var c=(e,s,r)=>new Promise((d,o)=>{var n=t=>{try{a(r.next(t))}catch(l){o(l)}},i=t=>{try{a(r.throw(t))}catch(l){o(l)}},a=t=>t.done?d(t.value):Promise.resolve(t.value).then(n,i);a((r=r.apply(e,s)).next())});import{B as D,b as G}from"./index.eb75c359.js";import{Q as $}from"./index.e28abc18.js";import{az as L,a as N,c as q,dg as I,v as j,fe as w,aB as m,o as g,j as u,B as v,n as z,m as M,t as h,C as V,k as C,aC as O,ff as T,fg as A,fh as E,G as F}from"./index.c8efd86c.js";import{D as H}from"./index.59448792.js";import"./useWindowSizeFn.569f2c34.js";import"./FullscreenOutlined.5ec4a1b8.js";import"./download.b01f8fdc.js";const J=N({name:"QrModal",components:{BasicModal:D,QrCode:$,Divider:H},emits:["success","register"],setup(e,{emit:s}){const{t:r}=q(),{hasPermission:d}=I(),o=j({}),{createMessage:n}=F(),[i,{setModalProps:a}]=G(f=>c(this,null,function*(){try{a({showCancelBtn:!1,showOkBtn:!1,confirmLoading:!0}),o.value=f.record;const B=yield w(o.value.id);o.value.googleQrUrl=B.googleQrUrl,o.value.googleSecret=B.googleSecret}finally{a({confirmLoading:!1})}}));function t(){return c(this,null,function*(){try{a({confirmLoading:!0}),T(o.value.id).then(()=>{w(o.value.id).then(f=>{o.value.googleQrUrl=f.googleQrUrl,o.value.googleSecret=f.googleSecret,o.value.googleBind=!1,s("success",{isUpdate:!0,values:p(y({},o.value),{id:o.value.id})})})})}finally{a({confirmLoading:!1})}})}function l(){return c(this,null,function*(){A(o.value.id).then(()=>{o.value.googleVerify=!0,n.success(r("sys.user.google.openMessage")),s("success",{isUpdate:!0,values:p(y({},o.value),{id:o.value.id})})})})}function k(){return c(this,null,function*(){E(o.value.id).then(()=>{o.value.googleVerify=!1,n.success(r("sys.user.google.closeMessage")),s("success",{isUpdate:!0,values:p(y({},o.value),{id:o.value.id})})})})}return{t:r,hasPermission:d,rowRecord:o,qrModal:i,resetSecret:t,openVerify:l,closeVerify:k}}}),K={class:"msg",style:{"text-align":"center"}},W=M("br",null,null,-1),X={style:{"text-align":"center"}};function Y(e,s,r,d,o,n){const i=m("QrCode"),a=m("a-button"),t=m("Divider"),l=m("BasicModal");return g(),u(l,O(e.$attrs,{onRegister:e.qrModal,title:e.t("sys.user.google.title")}),{default:v(()=>[z(i,{style:{"text-align":"center"},value:e.rowRecord.googleQrUrl,"onUpdate:value":s[0]||(s[0]=k=>e.rowRecord.googleQrUrl=k),width:300,options:{color:{dark:"#000000"}}},null,8,["value"]),M("div",K,h(e.rowRecord.googleSecret),1),W,M("div",X,[e.hasPermission("sys:user:reset-google-secret")?(g(),u(a,{key:0,class:"mb-2",type:"primary",onClick:e.resetSecret},{default:v(()=>[V(h(e.t("sys.user.google.reset")),1)]),_:1},8,["onClick"])):C("",!0),e.hasPermission("sys:user:google-verify")?(g(),u(t,{key:1,type:"vertical"})):C("",!0),!e.rowRecord.googleVerify&&e.hasPermission("sys:user:google-verify")?(g(),u(a,{key:2,class:"mb-2",type:"primary",onClick:e.openVerify},{default:v(()=>[V(h(e.t("sys.user.google.openVerify")),1)]),_:1},8,["onClick"])):C("",!0),e.rowRecord.googleVerify&&e.hasPermission("sys:user:google-verify")?(g(),u(a,{key:3,class:"mb-2",type:"primary",onClick:e.closeVerify},{default:v(()=>[V(h(e.t("sys.user.google.closeVerify")),1)]),_:1},8,["onClick"])):C("",!0)])]),_:1},16,["onRegister","title"])}var le=L(J,[["render",Y]]);export{le as default};
