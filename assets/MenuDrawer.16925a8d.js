var q=Object.defineProperty;var b=Object.getOwnPropertySymbols;var v=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable;var g=(e,s,t)=>s in e?q(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t,h=(e,s)=>{for(var t in s||(s={}))v.call(s,t)&&g(e,t,s[t]);if(b)for(var t of b(s))x.call(s,t)&&g(e,t,s[t]);return e};var y=(e,s,t)=>new Promise((n,i)=>{var p=a=>{try{u(t.next(a))}catch(l){i(l)}},m=a=>{try{u(t.throw(a))}catch(l){i(l)}},u=a=>a.done?n(a.value):Promise.resolve(a.value).then(p,m);u((t=t.apply(e,s)).next())});import{B as E,n as F}from"./useForm.64137a1f.js";import{c as B,bS as d,b6 as O,ez as c,eA as C,eB as A,az as L,a as U,v as V,f as $,i as w,aB as I,o as G,j,B as z,n as Y,aC as K,eK as W,eM as H,eN as J}from"./index.c8efd86c.js";import{T as D}from"./index.8f1c0509.js";import{r as Q,S as M,c as X,d as Z,e as ee,f as te}from"./dict.b085f5a7.js";import{B as oe,a as se}from"./index.29932cc5.js";const{t:o}=B(),ye=[{title:o("sys.menu.name"),dataIndex:"name",width:200,align:"left",customRender:({record:e})=>e.icon?d("span",{},[d(O,{icon:e.icon})," "+e.name]):e.name},{title:o("sys.menu.routePath"),dataIndex:"routePath",width:180},{title:o("sys.menu.type"),dataIndex:"type",width:100,customRender:({record:e})=>{const s=e.type;let t;switch(s){case c.DIRECTORY:t="blue";break;case c.MENU:t="cyan";break;default:t="green";break}return d(D,{color:t},()=>Q.get(s))}},{title:o("sys.menu.sort"),dataIndex:"sort",width:100},{title:o("sys.menu.permission"),dataIndex:"permission",width:180},{title:o("common.status"),dataIndex:"status",width:100,customRender:({record:e})=>{const t=e.status===M.NORMAL,n=t?"green":"red",i=o(t?"common.enable":"common.disable");return d(D,{color:n},()=>i)}},{title:o("common.createTime"),dataIndex:"createTime",ellipsis:!0},{title:o("common.updateTime"),dataIndex:"updateTime",ellipsis:!0}],ne=e=>e===c.DIRECTORY,R=e=>e===c.MENU,T=e=>e===c.BUTTON,we=[],ae=[{field:"type",label:o("sys.menu.type"),component:"RadioButtonGroup",required:!0,defaultValue:c.DIRECTORY,componentProps:{options:X}},{field:"scope",label:o("sys.menu.scope"),component:"RadioButtonGroup",defaultValue:C.ADMIN,required:!0,componentProps:{options:Z,mode:"multiple"}},{field:"name",label:o("sys.menu.name"),component:"Input",required:!0},{field:"parentId",label:o("sys.menu.parent"),component:"TreeSelect",componentProps:{fieldNames:{label:"name",key:"id",value:"id"},getPopupContainer:()=>document.body}},{field:"icon",label:o("sys.menu.icon"),component:"IconPicker",required:!0,ifShow:({values:e})=>!T(e.type)},{field:"routePath",label:o("sys.menu.routePath"),component:"Input",required:!0,ifShow:({values:e})=>R(e.type)},{field:"target",label:o("sys.menu.target"),component:"RadioButtonGroup",required:!0,defaultValue:A.MAIN,componentProps:{options:ee},ifShow:({values:e})=>R(e.type)},{field:"apiUrl",label:"\u63A5\u53E3\u5730\u5740",component:"Input",required:({values:e})=>T(e.type),ifShow:({values:e})=>!ne(e.type)},{field:"permission",label:o("sys.menu.permission"),component:"Input"},{field:"sort",label:o("sys.menu.sort"),component:"InputNumber",required:!0},{field:"status",label:o("common.status"),component:"RadioButtonGroup",required:!0,defaultValue:M.NORMAL,componentProps:{options:te}},{field:"remarks",label:o("common.remarks"),component:"InputTextArea",componentProps:{rows:3},required:!1}],re=U({name:"MenuDrawer",components:{BasicDrawer:oe,BasicForm:E},emits:["success","register"],setup(e,{emit:s}){const{t}=B(),n=V(!0);let i;const[p,{resetFields:m,setFieldsValue:u,updateSchema:a,validate:l}]=F({labelWidth:100,schemas:ae,showActionButtonGroup:!1,baseColProps:{lg:12,md:24}}),[P,{setDrawerProps:f,closeDrawer:S}]=se(r=>y(this,null,function*(){yield m(),f({confirmLoading:!1}),n.value=!!(r!=null&&r.isUpdate);const N=yield W();yield a({field:"parentId",componentProps:{treeData:N}}),w(n)&&(yield u(h({},r.record)),i=r.record.id)})),_=$(()=>w(n)?t("sys.menu.update"):t("sys.menu.create"));function k(){return y(this,null,function*(){try{const r=yield l();f({confirmLoading:!0}),w(n)?(r.id=i,yield J(r)):yield H(r),S(),s("success")}finally{f({confirmLoading:!1})}})}return{registerDrawer:P,registerForm:p,getTitle:_,handleSubmit:k}}});function ie(e,s,t,n,i,p){const m=I("BasicForm"),u=I("BasicDrawer");return G(),j(u,K(e.$attrs,{onRegister:e.registerDrawer,showFooter:"",title:e.getTitle,width:"50%",onOk:e.handleSubmit}),{default:z(()=>[Y(m,{onRegister:e.registerForm},null,8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}var ue=L(re,[["render",ie]]),be=Object.freeze(Object.defineProperty({__proto__:null,default:ue},Symbol.toStringTag,{value:"Module"}));export{ue as M,be as a,ye as c,we as s};
